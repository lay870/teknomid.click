<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04 - Teknomid Click</title><meta name="description" content="Logrotate adalah utilitas sistem yang mengelola rotasi otomatis dan kompresi file log. Jika file log tidak rotate, dikompresi, dan dipangkas secara"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://teknomid.click/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/"><link rel="amphtml" href="https://teknomid.click/amp/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/"><link rel="alternate" type="application/atom+xml" href="https://teknomid.click/feed.xml"><link rel="alternate" type="application/json" href="https://teknomid.click/feed.json"><meta property="og:title" content="Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04 - Teknomid Click "><meta property="og:image" content="https://teknomid.click/media/posts/196/Figure-6_large.webp"><meta property="og:site_name" content="Teknomid Click"><meta property="og:description" content="Logrotate adalah utilitas sistem yang mengelola rotasi otomatis dan kompresi file log. Jika file log tidak rotate, dikompresi, dan dipangkas secara"><meta property="og:url" content="https://teknomid.click/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/"><meta property="og:type" content="article"><meta property="fb:app_id" content="800151050785537"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@Teknomid_com"><meta name="twitter:title" content="Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04 - Teknomid Click "><meta name="twitter:description" content="Logrotate adalah utilitas sistem yang mengelola rotasi otomatis dan kompresi file log. Jika file log tidak rotate, dikompresi, dan dipangkas secara"><meta name="twitter:image" content="https://teknomid.click/media/posts/196/Figure-6_large.webp"><link rel="shortcut icon" href="https://teknomid.click/media/website/icon.png" type="image/png"><link rel="shortcut icon" href="https://teknomid.click/media/website/icon.png" type="image/png"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://teknomid.click/assets/css/style.css?v=e745adb44562e2c6dea39d449e43d58a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://teknomid.click/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/"},"headline":"Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04","datePublished":"2022-01-07T20:50","dateModified":"2022-01-21T23:10","image":{"@type":"ImageObject","url":"https://teknomid.click/media/posts/196/Figure-6_large.webp","height":182,"width":346},"description":"Logrotate adalah utilitas sistem yang mengelola rotasi otomatis dan kompresi file log. Jika file log tidak rotate, dikompresi, dan dipangkas secara","author":{"@type":"Person","name":"Teknomid","url":"https://teknomid.click/authors/teknomid/"},"publisher":{"@type":"Organization","name":"Teknomid","logo":{"@type":"ImageObject","url":"https://teknomid.click/media/website/Teknomid-Logo.png","height":105,"width":360}}}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7286829343387415" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script></head><body><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-WR3Q5HW&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics><script>window.__lc = window.__lc || {};
    window.__lc.license = 14355531;
    ;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.livechatinc.com/tracking.js",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice))</script><noscript><a href="https://www.livechat.com/chat-with/14355531/" rel="nofollow">Chat with us</a>, powered by <a href="https://www.livechat.com/?welcome" rel="noopener nofollow" target="_blank">LiveChat</a></noscript><header class="header" id="js-header"><a href="https://teknomid.click/" class="logo"><img src="https://teknomid.click/media/website/Teknomid-Logo.png" alt="Teknomid Click"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://teknomid.click/" title="https://teknomid.online" target="_self">Home</a></li><li><a href="https://teknomid.click/tags/tutorial/" title="https://teknomid.online/tags/tutorial/" target="_self">Tutorial</a></li><li class="has-submenu"><a href="https://teknomid.click/tags/cloud/" title="https://teknomid.online/tags/cloud/" target="_self" aria-haspopup="true">Cloud</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.click/tags/google/" title="https://teknomid.online/tags/google/" target="_self">Google</a></li><li><a href="https://teknomid.click/tags/aws/" title="https://teknomid.online/tags/aws/" target="_self">Aws</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.click/tags/operating-system/" title="https://teknomid.online/tags/operating-system/" target="_self" aria-haspopup="true">Systems</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.click/tags/linux/" title="https://teknomid.online/tags/linux/" target="_self" rel="https://teknomid.online/tags/linux/">Linux</a></li><li><a href="https://teknomid.click/tags/macos/" title="https://teknomid.online/tags/macOS/" target="_self" rel="https://teknomid.online/tags/macOS/">MacOS</a></li><li class="https://teknomid.online/tags/windows/"><a href="https://teknomid.click/tags/windows/" title="Windows" target="_self" rel="https://teknomid.online/tags/windows/">Windows</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.click/tags/applikasi/" title="https://teknomid.online/tags/applikasi/" target="_self" aria-haspopup="true">Applikasi</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.click/tags/mobile-applikasi/" title="https://teknomid.online/tags/mobile-applikasi/" target="_self" rel="https://teknomid.online/tags/appmobile/">App-Mobile</a></li><li><a href="https://teknomid.click/tags/windows-applikasi/" title="https://teknomid.online/tags/windows-applikasi/" target="_self" rel="https://teknomid.online/tags/appwindows/">App-Windows</a></li><li><a href="https://teknomid.click/tags/linux-applikasi/" title="https://teknomid.online/tags/linux-applikasi/" target="_self" rel="https://teknomid.online/tags/applinux/">App-Linux</a></li><li><a href="https://teknomid.click/tags/macos-applikasi/" title="https://teknomid.online/tags/macos-applikasi/" target="_self" rel="https://teknomid.online/tags/appmacos/">App-MacOS</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.click/tags/tech-gadgets/" title="https://teknomid.online/tags/tech-gadgets/" target="_self" aria-haspopup="true">Tech &amp; Gadgets</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.click/tags/handphone/" title="https://teknomid.online/tags/handphone/" target="_self">Handphone</a></li><li><a href="https://teknomid.click/tags/" title="https://teknomid.online/tags/elektronik/" target="_self" rel="Elektronika">Elektronika</a></li><li><a href="https://teknomid.click/tags/" title="https://teknomid.online/tags/crypto/" target="_self" rel="Crypto">Crypto</a></li><li><a href="https://teknomid.click/tags/laptop/" title="https://teknomid.online/tags/laptop/" target="_self" rel="Laptop">Laptop</a></li></ul></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><form action="https://teknomid.click/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" aria-label="Search input" placeholder="search..." autofocus="autofocus"> <button class="search__submit">Search</button></form></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false" height="18" width="18"><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#search"/></svg></button></div></header><ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemprop="item" href="https://teknomid.click/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"></li>›<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" itemid="" href=""><span itemprop="name"></span></a><meta itemprop="position" content="2"></li>›<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><span itemprop="name">Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04 - Teknomid Click</span><meta itemprop="position" content="3"></li></ol><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://teknomid.click/tags/tutorial/" class="post__maintag">TUTORIAL</a><h1 class="post__title">Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04</h1><div class="post__meta"><div class="post__author">By <a href="https://teknomid.click/authors/teknomid/" class="invert" rel="author" title="Teknomid">Teknomid</a></div><time datetime="2022-01-07T20:50">January 7, 2022</time></div></header><figure class="post__featured-image"><img src="https://teknomid.click/media/posts/196/Figure-6_large.webp" srcset="https://teknomid.click/media/posts/196/responsive/Figure-6_large-xs.webp 300w, https://teknomid.click/media/posts/196/responsive/Figure-6_large-sm.webp 480w, https://teknomid.click/media/posts/196/responsive/Figure-6_large-md.webp 768w, https://teknomid.click/media/posts/196/responsive/Figure-6_large-lg.webp 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="182" width="346" alt="Logrotate "><figcaption>Teknomid</figcaption></figure><div class="post__inner"><div class="post__entry"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1for6u3oo3mf">Persyaratan</a><ul><li><a href="#mcetoc_1for6u3oo3mg">Langkah 1 - Mengonfirmasi Versi Logrotate Anda</a></li><li><a href="#mcetoc_1for6u3oo3mh">Langkah 2 - Explore Konfigurasi Logrotate</a></li><li><a href="#mcetoc_1for6u3oo3mi">Langkah 3 - Setting Contoh Konfigurasi</a><ul><li><a href="#mcetoc_1for6u3oo3mj">1.  Buat file konfigurasi Logrotate baru dan letakkan di /etc/logrotate.d/.</a></li><li><a href="#mcetoc_1for6u3oo3mk">2.  Buat file konfigurasi baru dan jalankan di luar pengaturan Logrotate default Ubuntu.</a></li></ul></li><li><a href="#mcetoc_1for6u3oo3ml">Langkah 4 - Membuat Konfigurasi Logrotate Independen</a></li></ul></li><li><a href="#mcetoc_1for6u3oo3mm">Kesimpulan</a></li></ul></div></td></tr></tbody></table><div class="align-left">Logrotate adalah utilitas sistem yang mengelola rotasi otomatis dan kompresi file log. Jika file log tidak rotate, dikompresi, dan dipangkas secara berkala, mereka akhirnya dapat menghabiskan semua ruang disk yang tersedia pada sistem.<br><br></div><div class="align-left">Logrotate sudah terinstall secara default di Ubuntu 20.04, dan diatur untuk menangani kebutuhan rotasi log dari semua paket yang diinstal, termasuk rsyslog, prosesor log sistem default.<br><br></div><div class="align-left">Pada artikel ini, kita akan menjelajahi konfigurasi Logrotate default, lalu mengonfigurasi rotasi log untuk aplikasi yang ada di system kita.</div><h3 id="mcetoc_1for6u3oo3mf" class="align-left"><span style="color: #2dc26b;">Persyaratan</span></h3><div class="align-left">Tutorial ini mengasumsikan Anda memiliki server Ubuntu 20.04, dengan pengguna non-root sudo-enabled, seperti yang dijelaskan dalam Pengaturan Server Awal dengan Ubuntu 20.04 .</div><div class="align-left"> </div><div class="align-left">Logrotate juga tersedia di banyak distribusi Linux lainnya, tetapi konfigurasi defaultnya mungkin sangat berbeda. Bagian lain dari tutorial ini akan tetap berlaku selama versi Logrotate Anda mirip dengan Ubuntu 20.04. Ikuti Langkah 1 untuk menentukan versi Logrotate Anda.</div><div class="align-left"> </div><div class="align-left">Masuk ke server Anda sebagai user sudoer untuk memulai.</div><h4 id="mcetoc_1for6u3oo3mg" class="align-left"><span style="color: #2dc26b;">Langkah 1 - Mengonfirmasi Versi Logrotate Anda</span><br><br></h4><div class="align-left">Logrotate diinstal secara default di Ubuntu. Namun, jika Anda perlu menginstalnya, jalankan perintah berikut untuk memperbarui daftar paket dan mengambil paket:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div><span style="color: var(--color);">sudo apt update</span></div><div><span style="color: var(--color);">sudo apt install logrotate</span></div></td></tr></tbody></table></div><div class="align-left">Jika Anda menggunakan server non-Ubuntu, pastikan terlebih dahulu Logrotate diinstal dan cek versinya:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">logrotate --version<table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div><span style="text-decoration: underline;">Output</span></div><div>logrotate 3.14.0</div><div>Default mail command:       /usr/bin/mail</div><div>Default compress command:   /bin/gzip</div><div>Default uncompress command: /bin/gunzip</div><div>Default compress extension: .gz</div><div>Default state file path:    /var/lib/logrotate/status</div><div>ACL support:                yes</div><div>SELinux support:            yes</div></td></tr></tbody></table></td></tr></tbody></table></div><div class="align-left"> </div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-right: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><strong><em><a href="https://teknomid.click/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/">Baca Juga: Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</a></em></strong></td></tr></tbody></table></div><div class="align-left"><br>Jika Logrotate diinstal tetapi versinya sangat berbeda, Anda mungkin mengalami masalah dengan beberapa opsi konfigurasi yang dieksplorasi dalam tutorial ini. Lihat dokumentasi untuk versi spesifik Logrotate Anda dengan membaca manualnya (man):</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">man logrotate</td></tr></tbody></table></div><div> </div><div class="align-left">Anda juga dapat melihat versi online dari dokumentasi Logrotate. Selanjutnya kita akan melihat struktur konfigurasi default Logrotate di Ubuntu.</div><h4 id="mcetoc_1for6u3oo3mh" class="align-left"><span style="color: #2dc26b;">Langkah 2 - Explore Konfigurasi Logrotate</span><br><br></h4><div class="align-left">Informasi konfigurasi Logrotate umumnya dapat ditemukan di dua tempat di Ubuntu:</div><div class="align-left"><span style="color: var(--color);">/etc/logrotate.conf</span> :  file ini berisi beberapa pengaturan default dan mengatur rotasi untuk beberapa log yang tidak dimiliki oleh paket sistem mana pun. Itu juga menggunakan includepernyataan untuk menarik konfigurasi dari file apa pun di direktori <span style="color: var(--color);">/etc/logrotate.d</span> .</div><div class="align-left"> </div><div class="align-left"><span style="color: var(--color);">/etc/logrotate.d/ </span>: di sinilah paket apa pun yang Anda instal yang memerlukan bantuan dengan rotasi log akan menempatkan konfigurasi Logrotate-nya. Pada instalasi standar, Anda seharusnya sudah memiliki file di sini untuk alat sistem inti seperti apt, dpkg, rsyslogdan seterusnya.</div><div class="align-left"> </div><div class="align-left">Secara default, <span style="color: var(--color);">logrotate.conf</span> akan mengonfigurasi rotasi log mingguan, dengan file log yang dimiliki oleh pengguna root dan grup syslog , dengan empat file log disimpan pada satu waktu ( rotate 4), dan file log kosong baru dibuat setelah yang sekarang diputar ( create).</div><div class="align-left"> </div><div class="align-left">Mari kita lihat file konfigurasi Logrotate paket di<span style="color: var(--color);"> /etc/logrotate.d</span>. cat file untuk apt utilitas package:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">cat /etc/logrotate.d/apt<table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div><span style="text-decoration: underline;">Output</span></div><div>/var/log/apt/term.log {</div><div>  rotate 12</div><div>  monthly</div><div>  compress</div><div>  missingok</div><div>  notifempty</div><div>}</div><div>/var/log/apt/history.log {</div><div>  rotate 12</div><div>  monthly</div><div>  compress</div><div>  missingok</div><div>  notifempty</div><div>}</div></td></tr></tbody></table></td></tr></tbody></table></div><div> </div><div class="align-left">File ini berisi blok konfigurasi untuk dua file log yang berbeda dalam <span style="color: var(--color);">/var/log/apt/direktori</span> : <span style="color: var(--color);">term.log</span> dan <span style="color: var(--color);">history.log</span>. Mereka berdua memiliki pilihan yang sama. Opsi apa pun yang tidak disetel dalam blok konfigurasi ini akan mewarisi nilai default atau yang disetel dalam <span style="color: var(--color);">/etc/logrotate.conf</span>.<br><br>Pengaturan apa pun dalam file logrotate akan menggantikan nilai default logrotate, yang dikonfigurasi dalam <span style="color: var(--color);">/etc/logrotate.conf</span>. Opsi yang disetel untuk aptlog adalah:</div><div class="align-left"><span style="color: var(--color);">rotate 12:</span> menyimpan dua belas file log lama. Ini menimpa rotate 4default.</div><div class="align-left">monthly: putar sebulan sekali. Ini menimpa weekly default.<br><br></div><div class="align-left"><span style="color: var(--color);">compress:</span> kompres file yang diputar. ini menggunakan gzipsecara default dan menghasilkan file yang diakhiri dengan .gz. Perintah kompresi dapat diubah menggunakan compress cmd opsi.</div><div class="align-left"> </div><div class="align-left"><span style="color: var(--color);">missingok:</span> jangan menulis pesan kesalahan jika file log hilang.</div><div class="align-left">notifempty: jangan putar file log jika kosong.</div><div class="align-left"> </div><div class="align-left">File konfigurasi ini juga mewarisi createperilaku default , yang menginstruksikan Logrotate untuk membuat log baru setelah rotasi. Ini dapat diganti dengan nocreate, meskipun itu akan secara efektif menonaktifkan sebagian besar fungsi lainnya.</div><div class="align-left"> </div><div class="align-left">Ada lebih banyak opsi konfigurasi yang tersedia. Anda dapat membaca tentang semuanya dengan mengetik man logrotatedi baris perintah untuk membuka halaman manual Logrotate.</div><div class="align-left"> </div><div class="align-left">Selanjutnya, kita akan menyiapkan file konfigurasi untuk menangani log untuk layanan fiksi yang disebut your-app.</div><h4 id="mcetoc_1for6u3oo3mi" class="align-left"><span style="color: #2dc26b;">Langkah 3 - Setting Contoh Konfigurasi</span><br><br></h4><div class="align-left">Untuk mengelola file log menggunakan logrotate untuk aplikasi  pre-packaged dan pre-configured di system service, kami memiliki dua opsi:</div><h5 id="mcetoc_1for6u3oo3mj" class="align-left"><span style="color: #2dc26b;">1.  Buat file konfigurasi Logrotate baru dan letakkan di /etc/logrotate.d/.</span></h5><div class="align-left">Ini akan dijalankan setiap hari sebagai pengguna root bersama dengan semua pekerjaan Logrotate standar lainnya.</div><h5 id="mcetoc_1for6u3oo3mk" class="align-left"><span style="color: #2dc26b;">2.  Buat file konfigurasi baru dan jalankan di luar pengaturan Logrotate default Ubuntu.</span></h5><p class="align-left"> </p><div class="align-left">Ini hanya benar-benar diperlukan jika Anda perlu menjalankan Logrotate sebagai pengguna non- root , atau jika Anda ingin merotasi log lebih sering daripada setiap hari ( hourly konfigurasi di<span style="color: var(--color);"> /etc/logrotate.d/ </span>tidak akan efektif, karena pengaturan Logrotate sistem hanya berjalan sekali sehari).</div><div class="align-left"> </div><div class="align-left">Mari kita telusuri dua opsi ini dengan beberapa contoh penyiapan.</div><div class="align-left">Menambahkan Konfigurasi ke <span style="color: var(--color);">/etc/logrotate.d/</span></div><div class="align-left">Kami ingin mengonfigurasi rotasi log untuk server web app yang menempatkan <span style="color: var(--color);">access.log</span> dan <span style="color: var(--color);">error.log</span> ke <span style="color: var(--color);">/var/log/your-app/</span>. Ini berjalan sebagai <span style="color: var(--color);">www-data</span> pengguna dan grup.</div><div class="align-left"> </div><div class="align-left">Untuk menambahkan konfigurasi your-appfile log ke <span style="color: var(--color);">/etc/logrotate.d/</span>, pertama buka file baru di<span style="color: var(--color);"> /etc/logrotate.d</span> direktori menggunakan nanoatau editor pilihan Anda:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><p><span style="color: var(--color);">sudo nano /etc/logrotate.d/your-app</span></p><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div>/etc/logrotate.d/ your-app</div><div>/var/log/your-app/*.log {</div><div>    daily</div><div>    missingok</div><div>    rotate 14</div><div>    compress</div><div>    notifempty</div><div>    create 0640 www-data www-data</div><div>    sharedscripts</div><div>    postrotate</div><div>        systemctl reload your-app</div><div>    endscript</div><div>}</div></td></tr></tbody></table></td></tr></tbody></table></div><div> </div><div class="align-left">Beberapa arahan konfigurasi baru dalam file ini adalah:</div><div class="align-left"><span style="color: var(--color);">create 0640 www-data www-data</span> :  ini membuat file log kosong baru setelah rotasi, dengan izin tertentu ( <span style="color: var(--color);">0640</span>), user (<span style="color: var(--color);">www-data</span>), dan grup (<span style="color: var(--color);">www-data</span>).</div><div class="align-left"> </div><div class="align-left"><span style="color: var(--color);">shared scripts</span> : tanda ini berarti bahwa script apa pun yang ditambahkan ke konfigurasi hanya dijalankan sekali per proses, bukan untuk setiap file yang diputar. Karena jalur menyertakan wildcard , konfigurasi ini akan cocok dengan sejumlah file log di direktori.</div><div class="align-left"> </div><div class="align-left">Tanpa opsi, skrip yang ditentukan dalam akan berjalan setiap kali logrotate memproses file log tanpa opsi ini .<br><span style="color: var(--color);">/var/log/your-app/*.log*your-app</span> shared scripts post rotate</div><div class="align-left">postrotateto endscript : blok ini berisi skrip untuk dijalankan setelah file log diputar.</div><div class="align-left"> </div><div class="align-left">Dalam hal ini kami memuat ulang aplikasi contoh kami. Ini terkadang diperlukan agar aplikasi Anda beralih ke file log yang baru dibuat. Perhatikan bahwa postrotateberjalan sebelum log dikompresi. Kompresi bisa memakan waktu lama, dan perangkat lunak</div><div class="align-left"> </div><div class="align-left">Anda harus segera beralih ke file log baru. Untuk tugas yang perlu dijalankan setelah log dikompresi, gunakan lastaction blok sebagai gantinya.</div><div class="align-left">Untuk menyimpan dan keluar nano, tekan Ctrl+X, dan saat diminta, Ylalu Enter. Anda dapat menguji file konfigurasi dengan melakukan dry run:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">sudo logrotate /etc/logrotate.conf --debug</td></tr></tbody></table></div><div> </div><div class="align-left">Perintah ini memanggil logrotate, mengarahkannya ke file konfigurasi standar, dan mengaktifkan mode debug.</div><div class="align-left">Informasi akan dicetak tentang file log mana yang ditangani Logrotate dan apa yang akan dilakukan terhadapnya. Jika semuanya terlihat baik, Anda selesai.</div><div class="align-left"> </div><div class="align-left">Pekerjaan Logrotate standar akan berjalan sekali sehari dan menyertakan konfigurasi baru Anda.</div><div class="align-left">Selanjutnya, kita akan mencoba setup yang tidak menggunakan konfigurasi default Ubuntu sama sekali.</div><h4 id="mcetoc_1for6u3oo3ml" class="align-left"><span style="color: #2dc26b;">Langkah 4 - Membuat Konfigurasi Logrotate Independen</span><br><br></h4><div class="align-left">Dalam contoh ini kami memiliki aplikasi yang berjalan sebagai pengguna kami sammy, menghasilkan log yang disimpan di /home/sammy/logs/. Kami ingin memutar log ini setiap jam, jadi kami perlu mengaturnya di luar /etc/logrotate.dstruktur yang disediakan oleh Ubuntu.</div><div class="align-left">Pertama, kita akan membuat file konfigurasi di direktori home kita. Buka di editor teks:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">nano /home/sammy/logrotate.conf<table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div>/home/sammy/logrotate.conf</div><div>/home/sammy/logs/*.log {</div><div>    hourly</div><div>    missingok</div><div>    rotate 24</div><div>    compress</div><div>    create</div><div>}</div></td></tr></tbody></table></td></tr></tbody></table></div><div> </div><div class="align-left">Simpan dan tutup file. Kami telah menemukan semua opsi ini di langkah sebelumnya, tetapi mari kita rangkum: konfigurasi ini akan memutar file setiap jam, mengompresi dan menyimpan dua puluh empat log lama dan membuat file log baru untuk menggantikan yang diputar.</div><div class="align-left"> </div><div class="align-left">Anda harus menyesuaikan konfigurasi agar sesuai dengan aplikasi Anda, tetapi ini adalah awal yang baik.</div><div class="align-left">Untuk menguji apakah konfigurasi berfungsi, mari buat file log. Pertama cdke direktori home pengguna Anda menggunakan perintah <span style="color: var(--color);">cd ~</span>.<br><br>Kemudian buat direktori untuk log menggunakan mkdirperintah. Terakhir buat file kosong di logsdirektori menggunakan touchperintah. Jalankan perintah berikut untuk menyelesaikan langkah-langkah ini:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div><span style="color: var(--color);">cd ~</span></div><div><span style="color: var(--color);">mkdir logs</span></div><div><span style="color: var(--color);">touch logs/access.log</span></div></td></tr></tbody></table></div><div> </div><div class="align-left">Sekarang kita memiliki file log kosong di tempat yang tepat, mari jalankan perintah  logrotate.</div><div class="align-left">Karena log kepemilikan user sammy kita tidak perlu menggunakan sudo. Namun, kita tidak perlu menentukan flag berkas.</div><div class="align-left"> </div><div class="align-left">File ini mencatat apa yang logrotate ditemukan dan tindakan apa pun yang dilakukan saat terakhir dijalankan, sehingga tahu apa yang harus dilakukan saat berikutnya dijalankan. Pelacakan status ini ditangani untuk kami saat menggunakan<span style="color: var(--color);"> /etc/logrotate.conf</span> konfigurasi default .</div><div class="align-left"> </div><div class="align-left">File status disimpan di <span style="color: var(--color);">/var/lib/logrotate/status.</span> Karena kita tidak menggunakan konfigurasi default, kita perlu mengkonfigurasi lokasi file status secara manual.</div><div class="align-left">Kami akan meminta Logrotate meletakkan file status tepat di direktori home kami untuk contoh ini. Itu bisa pergi ke mana saja yang dapat diakses dan nyaman.</div><div class="align-left"> </div><div class="align-left">Jalankan perintah berikut ini untuk menggunakan<span style="color: var(--color);"> /home/sammy/logrotate.conf</span> yang Anda buat dan untuk merekam status logrotate:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">logrotate /home/sammy/logrotate.conf --state /home/sammy/logrotate-state --verbose<table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div>Output</div><div>reading config file /home/sammy/logrotate.conf</div><div>Handling 1 logs</div><div>rotating pattern: /home/sammy/logs/*.log  hourly (24 rotations)</div><div>empty log files are rotated, old logs are removed</div><div>considering log /home/sammy/logs/access.log</div><div>  log does not need rotating</div></td></tr></tbody></table></td></tr></tbody></table></div><div> </div><div class="align-left">flag <span style="color: var(--color);">--verbose</span> akan menampilkan informasi detail tentang apa logrotate lakukan. Dalam hal ini tidak merotate apa pun. Ini adalah pertama kalinya Logrotate menemukan file log ini dan berumur nol jam jadi tidak boleh dirotasi.</div><div class="align-left"> </div><div class="align-left">Jika kami memeriksa file status menggunakan cat utilitas, kami akan mencatat bahwa Logrotate mencatat beberapa informasi tentang proses:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">cat /home/sammy/logrotate-state<table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);"><div>Output</div><div>logrotate state -- version 2</div><div>"/home/sammy/logs/access.log" 2021-12-3-19:0:0</div></td></tr></tbody></table></td></tr></tbody></table></div><div> </div><div class="align-left">Logrotate mencatat log yang dilihatnya dan kapan terakhir mempertimbangkannya untuk rotasi. Jika kita menjalankan perintah yang sama ini satu jam kemudian, log akan diputar seperti yang diharapkan.</div><div class="align-left"> </div><div class="align-left">Jika Anda ingin memaksa Logrotate untuk rotate file log padahal seharusnya tidak, gunakan <span style="color: var(--color);">--force</span> tanda:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">logrotate /home/sammy/logrotate.conf --state /home/sammy/logrotate-state --verbose --force</td></tr></tbody></table></div><div> </div><div class="align-left">Ini berguna saat menguji post rotate dan script lainnya.</div><div class="align-left">Terakhir, kita perlu menyiapkan tugas cron untuk menjalankan Logrotate setiap jam. Buka crontab pengguna Anda:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">crontab -e</td></tr></tbody></table></div><div> </div><div class="align-left">Ini akan membuka file teks. Jika ini adalah pertama kalinya Anda menggunakan cron, Anda mungkin diminta untuk memilih editor teks default. Jika Anda tidak memiliki preferensi, kami sarankan nanountuk pengguna baru.</div><div class="align-left"> </div><div class="align-left">Mungkin sudah ada beberapa komentar di file yang menjelaskan sintaks cron. Pindahkan kursor ke bawah ke baris kosong baru di akhir file dan tambahkan yang berikut ini:</div><div class="align-left"><table class="align-left" style="width: 100%; border-left: 1px solid var(--color); border-radius: 10px;" border="0.1"><tbody><tr><td style="padding: 7px; text-align: left; color: var(--color);">14 * * * * /usr/sbin/logrotate /home/sammy/logrotate.conf --state /home/sammy/logrotate-state</td></tr></tbody></table></div><div> </div><div class="align-left">Tugas ini akan berjalan pada menit ke-14 setiap jam, setiap hari. Ini menjalankan logrotate perintah yang hampir sama dengan yang kami jalankan sebelumnya, meskipun kami memperluas logrotateke jalur penuhnya<span style="color: var(--color);"> /usr/sbin/logrotate</span> agar aman. Ini adalah praktik yang baik untuk menggunakan jalur lengkap saat menulis tugas cron.</div><div class="align-left"> </div><div class="align-left">Untuk mempelajari lebih lanjut tentang cron, Anda dapat meninjau tutorial kami yang lain . Simpan file dan keluar. Ini akan menginstal crontab dan tugas kita akan berjalan pada jadwal yang ditentukan.</div><div class="align-left"> </div><div class="align-left">Jika kami mengunjungi kembali direktori log kami dalam waktu sekitar satu jam, kami akan menemukan file log yang diputar dan di compress access.log.1.gz(atau .2.gzjika Anda menjalankan Logrotate dengan --force flag).</div><h3 id="mcetoc_1for6u3oo3mm" class="align-left"><span style="text-decoration: underline; color: #2dc26b;">Kesimpulan</span></h3><div class="align-left">Dalam tutorial ini kami memverifikasi versi Logrotate kami, menjelajahi konfigurasi default Ubuntu Logrotate, dan menyiapkan dua jenis konfigurasi custom yang berbeda. Untuk mempelajari lebih lanjut tentang baris perintah dan opsi konfigurasi yang tersedia untuk Logrotate, Anda dapat membaca manualnya dengan menjalankan man logrotate di terminal Anda atau dengan mengunjungi dokumentasi <a href="#INTERNAL_LINK#/post/null" title="https://linux.die.net/man/8/logrotate">online </a>.</div><p class="align-left"> </p></div><footer><p class="post__last-updated">This article was updated on January 21, 2022</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://teknomid.click/tags/linux/">LINUX</a></li><li><a href="https://teknomid.click/tags/tutorial/">TUTORIAL</a></li></ul><aside class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fteknomid.click%2Fcara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004%2F" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fteknomid.click%2Fcara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004%2F&amp;media=https%3A%2F%2Fteknomid.click%2Fmedia%2Fposts%2F196%2FFigure-6_large.webp&amp;description=Cara%20Mengelola%20File%20Log%20dengan%20Logrotate%20di%20Ubuntu%2020.04" class="js-share pinterest" aria-label="Share with Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://api.whatsapp.com/send?text=Cara%20Mengelola%20File%20Log%20dengan%20Logrotate%20di%20Ubuntu%2020.04 https%3A%2F%2Fteknomid.click%2Fcara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004%2F" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#whatsapp"/></svg></a></aside></div><div class="post__bio author"><div><h3 class="h6 author__name"><a href="https://teknomid.click/authors/teknomid/" class="invert" title="Teknomid">Teknomid</a></h3></div></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://teknomid.click/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" rel="prev">Previous Post<h3 class="h6">Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</h3></a></div><div class="post__nav__next"><a class="post__nav__link" href="https://teknomid.click/aws-iam/" rel="prev">Next Post<h3 class="h6">AWS &quot;IAM&quot;</h3></a></div></nav></footer></div></article></div><div class="post__related"><div class="wrapper"><h2 class="h5">Related posts</h2><div class="l-grid l-grid--4"><article class="c-card"><a href="https://teknomid.click/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" class="c-card__image"><img src="https://teknomid.click/media/posts/195/free05.png" srcset="https://teknomid.click/media/posts/195/responsive/free05-xs.png 300w, https://teknomid.click/media/posts/195/responsive/free05-sm.png 480w, https://teknomid.click/media/posts/195/responsive/free05-md.png 768w, https://teknomid.click/media/posts/195/responsive/free05-lg.png 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="169" width="666" alt="Menghapus Cache"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://teknomid.click/tags/tutorial/">TUTORIAL</a></div><h3 class="c-card__title"><a href="https://teknomid.click/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" class="invert">Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</a></h3></header><p class="c-card__text">Pada artikel ini, kita akan melihat Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux. Di setiap sistem&hellip;</p><footer class="c-card__meta"><time datetime="2022-01-06T21:21">January 6, 2022</time><div class="c-card__comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#comments"/></svg> <a href="https://teknomid.click/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/#post-comments" data-disqus-identifier="195" class="invert" rel="nofollow">0</a></div></footer></div></article><article class="c-card"><a href="https://teknomid.click/cara-install-prometheus-di-linux-ubuntu/" class="c-card__image"><img src="https://teknomid.click/media/posts/194/prometheus-696x279.webp" srcset="https://teknomid.click/media/posts/194/responsive/prometheus-696x279-xs.webp 300w, https://teknomid.click/media/posts/194/responsive/prometheus-696x279-sm.webp 480w, https://teknomid.click/media/posts/194/responsive/prometheus-696x279-md.webp 768w, https://teknomid.click/media/posts/194/responsive/prometheus-696x279-lg.webp 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="lazy" height="279" width="696" alt="Cara Install Prometheus di Linux Ubuntu"></a><div class="c-card__wrapper"><header class="c-card__header"><div class="c-card__tag"><a href="https://teknomid.click/tags/tutorial/">TUTORIAL</a></div><h3 class="c-card__title"><a href="https://teknomid.click/cara-install-prometheus-di-linux-ubuntu/" class="invert">Cara Install Prometheus di Linux Ubuntu</a></h3></header><p class="c-card__text">Pengantar Prometheus adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-series.</p><footer class="c-card__meta"><time datetime="2021-12-18T15:04">December 18, 2021</time><div class="c-card__comments"><svg aria-hidden="true"><title>Comments</title><use xlink:href="https://teknomid.click/assets/svg/svg-map.svg#comments"/></svg> <a href="https://teknomid.click/cara-install-prometheus-di-linux-ubuntu/#post-comments" data-disqus-identifier="194" class="invert" rel="nofollow">0</a></div></footer></div></article></div></div></div></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 170,
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://teknomid.click/assets/js/scripts.min.js?v=d78591855e0ce96bf51239b499260e20"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner pcb__banner--left"><div class="pcb__inner"><div id="pcb-title" role="heading" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Save</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Save</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Save</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>